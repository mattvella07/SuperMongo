"use strict";var PageContainer=React.createClass({displayName:"PageContainer",getInitialState:function(){return{selectedDB:"",selectedCol:"",showCollections:!1,showActionArea:!1,showResultArea:!1}},handleDBClick:function(e){this.setState({selectedDB:e,showCollections:!0,showActionArea:!1,showResultArea:!1})},handleColClick:function(e){this.setState({selectedCol:e,showActionArea:!0,showResultArea:!1})},handleRun:function(e){this.query=e,this.setState({showResultArea:!0})},render:function(){return React.createElement("div",null,React.createElement("div",{className:"column sideBar"},React.createElement(DatabaseList,{source:this.props.allDBsApi,onDBClick:this.handleDBClick}),this.state.showCollections?React.createElement(CollectionList,{db:this.state.selectedDB,onColClick:this.handleColClick}):null),React.createElement("div",{className:"column"},this.state.showActionArea?React.createElement(ActionArea,{db:this.state.selectedDB,col:this.state.selectedCol,onRun:this.handleRun}):null,this.state.showResultArea?React.createElement(ResultArea,{db:this.state.selectedDB,col:this.state.selectedCol,query:this.query}):null))}}),DatabaseList=React.createClass({displayName:"DatabaseList",getInitialState:function(){return{dbNames:""}},componentDidMount:function(){$.get(this.props.source,function(e){for(var t=0;t<e.length;t++)this.setState({dbNames:this.state.dbNames.concat(","+e[t].name)})}.bind(this))},componentWillUnmount:function(){this.serverRequest.abort()},render:function(){var e=this,t=this.state.dbNames.split(",").map(function(t){return""!==t?React.createElement(Database,{db:t,onDBClick:e.props.onDBClick}):void 0});return React.createElement("div",{className:"databaseList"},React.createElement("h3",null,"Databases"),t)}}),Database=React.createClass({displayName:"Database",handleClick:function(e){$(".database").removeClass("clicked"),$(".collection").removeClass("clicked"),$(e.target).addClass("clicked"),this.props.onDBClick(e.target.innerHTML)},render:function(){return React.createElement("div",{className:"database",onClick:this.handleClick},this.props.db)}}),CollectionList=React.createClass({displayName:"CollectionList",getInitialState:function(){return{collectionNames:""}},componentWillReceiveProps:function(e){$.get("/api/collections/"+e.db,function(e){for(var t="",a=0;a<e.length;a++)0!==e[a].name.indexOf("system.")&&(t+=","+e[a].name);this.replaceState({collectionNames:t})}.bind(this))},componentDidMount:function(){$.get("/api/collections/"+this.props.db,function(e){for(var t=0;t<e.length;t++)0!==e[t].name.indexOf("system.")&&this.setState({collectionNames:this.state.collectionNames.concat(",",e[t].name)})}.bind(this))},componentWillUnmount:function(){this.serverRequest.abort()},render:function(){var e=this,t=this.state.collectionNames.split(",").map(function(t){return""!==t?React.createElement(Collection,{col:t,onColClick:e.props.onColClick}):void 0});return React.createElement("div",{className:"collectionList"},React.createElement("h3",null,"Collections in ",React.createElement("i",null,this.props.db)),t)}}),Collection=React.createClass({displayName:"Collection",handleClick:function(e){$(".collection").removeClass("clicked"),$(e.target).addClass("clicked"),this.props.onColClick(e.target.innerHTML)},render:function(){return React.createElement("div",{className:"collection",onClick:this.handleClick},this.props.col)}}),ActionArea=React.createClass({displayName:"ActionArea",onSubmit:function(e){e.preventDefault();var t="";this.queryKey.value&&(t+=":"===this.queryComparison.value?'{"'+this.queryKey.value+'"'+this.queryComparison.value+" "+this.queryVal.value+"}":'{"'+this.queryKey.value+'": {"'+this.queryComparison.value+'": '+this.queryVal.value+"} }"),this.props.onRun(t)},render:function(){var e=this;return React.createElement("div",{className:"actionArea"},React.createElement("form",{onSubmit:this.onSubmit},React.createElement("select",{name:"operations"},React.createElement("option",{value:"find"},"Find")),React.createElement("div",null,React.createElement("div",null,"Query:Â  ",React.createElement("input",{type:"text",placeholder:"Key",ref:function(t){return e.queryKey=t}}),React.createElement("select",{name:"comparison",ref:function(t){return e.queryComparison=t}},React.createElement("option",{value:":"},"Equals"),React.createElement("option",{value:"$lt"},"Less than"),React.createElement("option",{value:"$lte"},"Less than or equal to"),React.createElement("option",{value:"$gt"},"Greater than"),React.createElement("option",{value:"$gte"},"Greater than or equal to"),React.createElement("option",{value:"$ne"},"Not equal")),React.createElement("input",{type:"text",placeholder:"Value",ref:function(t){return e.queryVal=t}})),React.createElement("input",{type:"submit",value:"Run"}))))}}),ResultArea=React.createClass({displayName:"ResultArea",getInitialState:function(){return{result:""}},getData:function(e){var t=e||this.props,a="/api/find/"+t.db+"/"+t.col,n="";t.query&&(a+="/"+t.query),$.get(a,function(e){for(var t=0;t<e.length;t++){var a=e[t];n+="{";for(var l in a)a.hasOwnProperty(l)&&(n+=l+": "+a[l]+", ");n+="}"}this.replaceState({result:n}),$("#resultsLoading").hide()}.bind(this))},componentWillReceiveProps:function(e){this.getData(e)},componentDidMount:function(){this.getData()},componentWillUnmount:function(){this.serverRequest&&this.serverRequest.abort()},render:function(){var e=this.state.result.split("}").map(function(e){return""!==e?React.createElement("p",null,e+"}"):void 0});return React.createElement("div",{className:"resultArea"},React.createElement("p",{id:"resultsLoading"},"Loading..."),React.createElement("div",null,e))}});ReactDOM.render(React.createElement(PageContainer,{allDBsApi:"/api/databases"}),document.getElementById("content"));